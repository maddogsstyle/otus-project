<img src="https://img.shields.io/github/v/tag/maddogsstyle/otus-project?label=version" />

# Описание проекта
Данный проект является итоговой квалификационной работой по завершении курса "DevOps практики и инструменты"
Составными частями проекта являются:

1. Развернутая инфраструктура, включающая в себя:
	- Оркестратор микросервисов: Kubernetes (v1.22 для Яндекс.Облака)
	- Брокер сообщений: RabbitMQ (v3.11.7)
	- База данных: MongoDB (v4.0)

2. Сервис,обеспечивающий непрерывную интеграции/развертывание:
	- Менеджер CI/CD: Jenkins

3. Инструменты, осуществляющие логирование и мониторинг:
	- Prometheus (v2.39.1)
	- Grafana (v9.2.4)

4. Непосредственно приложение, состоящее из двух компонентов:
	- UI
	- Backend

# Описание приложения
Приложение представляет из себя поисковый сервис, обрабатывающий одну или несколько веб-страниц на предмет наличия заданных в поисковом запросе слов или словосочетаний.
В качестве результата работы сервис возвращает URL страниц наряду с количеством запрашивамых вхождений.

# Необходимые компоненты
Для работы приложения необходимы следующие утилиты:
- yc (при необходимости развертывания в Яндекс.Облаке)
- minikube (для локальной разработки)
- Helm

# Порядок установки

1. Разворачиваем кластер

а) (Только для Яндекс.Облака)
Кластер разворачивается автоматически средствами `yc`:
```
./cluster.sh
```
б) (Для локальной разработки)
Кластер разворачивается автоматически средствами minikube:
```
minikube start
```
2. После успешного разворачивания кластера необходимо установить project chart:

```
cd kubernetes/Charts
helm install project ./project
```
3. Наконец, можно выполнить команду

```
helm install crawler ./crawler
helm install ui ./ui
```
а) (для Яндекс.Облака) 
```
kubectl get svc
```
перейти по EXTERNAL IP для приложения `ui` и пользоваться развернутым сервисом.
б) (для локальной разработки)
```
kubectl port-forward --namespace default svc/project-ui 8000:80 
```
перейти по адресу `localhost:8000` и пользоваться развернутым сервисом.

4. CI/CD пайплайн реализован средствами Jenkins. 

# Первый старт

PRESS X TO WIN

# Мониторинг и логирование

## Prometheus

Для входа в UI необходимо выполнить команду:

```
kubectl port-forward svc/pro-kube-prometheus-stack-prometheus 9090
```

Prometheus будет доступен по адресу:

`http://localhost:9090/`

## Grafana

Для входа в UI необходимо выполнить команду:

```
kubectl port-forward svc/pro-grafana 8880
```

Grafana будет доступна по адресу:

`http://localhost:8880/`
